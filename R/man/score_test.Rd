% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/score_test.R
\name{score_test}
\alias{score_test}
\title{Score test for overidentification testing in linear IV models}
\usage{
score_test(
  formula = NULL,
  data = NULL,
  y = NULL,
  X = NULL,
  Z = NULL,
  W = NULL,
  weights = NULL,
  method = "2sls",
  errors = "hom",
  basmann = FALSE,
  lags = "rot",
  cluster_var = NULL,
  small_sample = FALSE,
  no_constant = NULL
)
}
\arguments{
\item{formula}{An object of class \code{formula} describing the IV regression model.
Should include two parts separated by \code{|}, where the left part specifies
the main equation and the right part specifies the instruments.}

\item{data}{A data frame containing the variables in the model.}

\item{y}{Numeric vector of the outcome variable.}

\item{X}{Matrix of endogenous regressors.}

\item{Z}{Matrix of instrumental variables.}

\item{W}{Matrix of included exogenous regressors. If NULL, an intercept is included.}

\item{weights}{Optional vector of weights.}

\item{method}{Character string specifying estimation method:
\itemize{
\item "2sls": Two-stage least squares (gives J-test or Sargan test)
\item "liml": Limited information maximum likelihood (gives KP-test)
}}

\item{errors}{Character string specifying variance estimator type:
\itemize{
\item "hom": Homoskedastic errors (gives Sargan test)
\item "het": Heteroskedasticity-robust (White)
\item "hac": HAC-robust (Newey-West)
\item "cluster": Cluster-robust
}}

\item{basmann}{Logical. If TRUE, uses Basmann's form of the test.}

\item{lags}{Specifies lags for Newey-West HAC estimator:
\itemize{
\item "rot": Rule of thumb (4*(n/100)^(2/9))
\item "plug-in": Plug-in method ((4/3)*(n/100)^(1/4))
\item numeric: User-specified number of lags
}}

\item{cluster_var}{Vector specifying clusters for cluster-robust variance estimation.}

\item{small_sample}{Logical. If TRUE, applies small-sample correction.}

\item{no_constant}{Logical. If TRUE, suppresses the constant term.}
}
\value{
An object of class "htest" containing:
\itemize{
\item statistic: The score test statistic
\item p.value: P-value based on chi-square distribution
\item parameter: Degrees of freedom
\item method: Description of test method used
\item data.name: Description of input data
\item coefficients: Estimated parameters
}
}
\description{
Implements various overidentification tests including the Sargan test,
Hansen J-test, and Kleibergen-Paap test for linear IV models. This function
implements the score test discussed in Windmeijer (2022) and Lane and Windmeijer (2024).
}
\details{
The function implements overidentification tests that allow users to assess
instrument validity when the number of instruments exceeds the number of
endogenous regressors. It supports both traditional (Sargan) and robust
(Hansen J, Kleibergen-Paap) test statistics.

The test statistic follows a chi-square distribution under the null hypothesis
of valid instruments, with degrees of freedom equal to the number of
overidentifying restrictions (number of instruments minus number of
endogenous regressors).
}
\examples{
\dontrun{
# Using formula interface
data(mroz, package = "sampleSelection")
score_test(wage ~ educ | exper + city, data = mroz)

# Using matrix interface with robust errors
score_test(y = y, X = X, Z = Z, 
          method = "liml",
          errors = "hac",
          lags = "rot")
          
# Using clustered standard errors
score_test(wage ~ educ | exper + city, 
          data = mroz,
          errors = "cluster",
          cluster_var = "id")
}

}
\references{
\itemize{
\item Sargan, J. D. (1958). The estimation of economic relationships using instrumental variables.
\item Hansen, L. P. (1982). Large sample properties of generalized method of moments estimators.
\item Kleibergen, F., & Paap, R. (2006). Generalized reduced rank tests using the singular value decomposition.
\item Windmeijer, F. (2021). Two-stage least squares as a score test.
\item Lane, S., & Windmeijer, F. (2024). Robust overidentification testing in linear IV models.
}
}
